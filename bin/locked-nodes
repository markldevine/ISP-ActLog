#!/usr/bin/bash

CMD1="lc01 -dataonly=yes -displaymode=list"
CMD2="lc02 -dataonly=yes -displaymode=list"

for NODE in `${CMD2} "SELECT NODE_NAME from NODES where LOCKED='YES'" | awk '$1 ~ /^NODE_NAME:/ {print $2}' | sort`
do
    if ${CMD2} q admin ${NODE} 1> /dev/null 2>&1
    then
- get CONTACT
- get EMAILADDRESS
- get TCP_ADDRESS
- get PLATFORM, ergo optfile
        echo ${CMD1} REGISTER ADMIN ${NODE} jgb6005th
        echo ${CMD1} GRANT AUTHORITY ${NODE} cl=node auth=owner node=${NODE}
        echo ${CMD2} REGISTER ADMIN ${NODE} jgb6005th contact="${CONTACT}" emailaddress="${EMAILADDRESS}" passexp=0
        echo ${CMD2} GRANT AUTHORITY ${NODE} cl=node auth=owner node=${NODE}
        echo ${CMD2} UNLOCK NODE ${NODE}
        echo ssh ${HOST} sudo dsmc q se -optfile=/
    fi
done
